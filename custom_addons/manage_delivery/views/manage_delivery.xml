<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="manage_delivery_form" model="ir.ui.view">
        <field name="name">manage.delivery.form</field>
        <field name="model">manage.delivery</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="select_delivery_invoice" type="object"
                            string="Select Delivery Invoices"
                            class="oe_highlight"
                            attrs="{'invisible':[('state','!=','draft')]}"/>
                    <button name="confirm" type="object" string="Confirm"
                            class="oe_highlight"
                            attrs="{'invisible':[('state','!=','draft')]}"/>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,confirm"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group>
                            <field name="delivery_boy"/>
                            <field name="mobile"/>
                        </group>
                        <group>
                            <field name="date"/>
                            <field name="transportation"/>
                            <field name="plate_number"
                                   attrs="{'invisible':[('transportation','not in',['1','2'])]}"/>
                        </group>

                    </group>
                    <notebook>
                        <page string="Delivery Orders">
                            <field name="manage_delivery_liens_ids">
                                <tree editable="bottom" create="0" delete="0">
                                    <field name="manage_delivery_id"
                                           invisible="1"/>
                                    <field name="account_move_id"/>
                                    <field name="partner_id"/>
                                    <field name="delivery_boy" invisible="1"/>
                                    <field name="street"/>
                                    <field name="zone"/>
                                    <field name="mobile"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>

                </sheet>
            </form>
        </field>
    </record>

    <record id="manage_delivery_tree" model="ir.ui.view">
        <field name="name">manage.delivery.tree</field>
        <field name="model">manage.delivery</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="delivery_boy"/>
                <field name="date"/>
                <field name="transportation"/>
                <field name="arrived_date"/>
                <field name="state" widget="badge"/>
            </tree>
        </field>
    </record>


    <record id="manage_delivery_sequence" model="ir.sequence">
        <field name="name">manage_delivery</field>
        <field name="code">manage.delivery</field>
        <field name="prefix">MDO/</field>
        <field name="padding">5</field>
        <field name="number_next">1</field>
        <field name="number_increment">1</field>
    </record>

    <record id="manage_delivery_action" model="ir.actions.act_window">
        <field name="name">Manage Delivery</field>
        <field name="res_model">manage.delivery</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Manage Delivery
            </p>
        </field>
    </record>

    <record id="manage_delivery_liens_tree" model="ir.ui.view">
        <field name="name">manage.delivery.liens.tree</field>
        <field name="model">manage.delivery.liens</field>
        <field name="arch" type="xml">
            <tree>
                <field name="manage_delivery_id"/>
                <field name="account_move_id"/>
                <field name="delivery_boy"/>
                <field name="partner_id"/>
                <field name="street"/>
                <field name="zone"/>
                <field name="mobile"/>
                <field name="amount"/>
                <field name="parent_state" invisible="1"/>
                <button name="delivery_status" type="object" string="Arrived"
                        icon="fa-icon_you_like"
                        attrs="{'invisible':['|',('state','in',['2','3']),('parent_state','!=','confirm')]}"/>
                <button name="not_arrived" type="object" string="Not Arrived"
                        icon="fa-icon_you_like"
                        attrs="{'invisible':['|',('state','in',['2','3']),('parent_state','!=','confirm')]}"/>
                <field name="state" widget="badge"
                       decoration-muted="state == '1'"
                       decoration-success="state == '2'"
                       decoration-danger="state == '3'"
                />
            </tree>
        </field>
    </record>


    <record id="manage_delivery_liens_action" model="ir.actions.act_window">
        <field name="name">Manage Delivery Liens</field>
        <field name="res_model">manage.delivery.liens</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('parent_state', '!=', 'draft')]</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Manage Delivery Liens
            </p>
        </field>
    </record>

    <menuitem id="manage_delivery_menu"
              name="Manage Delivery"
              web_icon="manage_delivery,static/description/icon.png"
    />
    <menuitem id="manage_delivery_orders_menu"
              parent="manage_delivery_menu"
              name="Manage Delivery"
    />
    <menuitem id="delivery_orders_menu"
              name="Delivery Orders"
              action="manage_delivery_action"
              parent="manage_delivery_orders_menu"
              sequence="2"/>
    <menuitem id="manage_delivery_liens_menu"
              name="Delivery Orders Liens"
              action="manage_delivery_liens_action"
              parent="manage_delivery_orders_menu"
              sequence="3"/>

    <menuitem id="configuration_menu"
              name="Configuration"
              parent="manage_delivery_menu"
              sequence="50"/>

    <template id="manage_delivery_inherit" name="Manage Delivery"
              customize_show="True"
              inherit_id="portal.portal_my_home" priority="100">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-call="portal.portal_docs_entry">
                <t t-set="title">Manage Delivery</t>
                <t t-set="url" t-value="'/manage/delivery'"/>
            </t>
        </xpath>
    </template>

    <template id="portal_product_availability" name="Portal availability">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Products Stock Availability</t>
            </t>
            <form class="s_website_form form-horizontal container-fluid mt32">
                <label class="col-md-3 col-sm-4 control-label" for="name">
                    Products Stock availability
                </label>
                <div class="col-sm-4 col-md-6 o_website_product_search">
                    <input type="text"
                           class="form-control o_portal_product_input"
                           id="product_name_input"
                           name="products_search" required=""
                           placeholder="Search products..."/>
                    <div aria-label="Search" title="Search" clickable="1"
                         class="btn oe_search_button btn-primary"
                         style="position: absolute;top: 0;right: 16px;background: transparent;border: none;">
                        <i class="fa fa-search" style="color: black;"/>
                    </div>
                </div>
                <div>
                    <div class="product_results_table col-sm-4 col-md-6"/>
                </div>
            </form>
        </t>
    </template>

    <template id="delivery_orders_portal" name="Delivery Orders">
        <t t-call="portal.portal_layout">
            <!--            <t t-set="breadcrumbs_searchbar" t-value="True"/>-->
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Delivery Orders</t>
            </t>
            <t t-call="portal.portal_table">
                <thead>
                    <tr class="active">
                        <!--                        <th>ID NO</th>-->
                        <th>Invoice</th>
                        <!--                        <th>Delivery</th>-->
                        <th>Customer</th>
                        <th>Street</th>
                        <th>Zone</th>
                        <th>Mobile</th>
                        <th>Amount</th>
                        <th>State</th>
                        <th></th>

                    </tr>
                </thead>
                <t t-foreach="orders" t-as="o">
                    <tr>
                        <!--                        <td>-->
                        <!--                            <span t-field="o.id"/>-->
                        <!--                        </td>-->
                        <td>
                            <a t-field="o.account_move_id.name" t-attf-href="/delivery/order/#{o.id}"/>
                        </td>
                        <!--                        <td>-->
                        <!--                            <span t-field="o.delivery_boy.name"/>-->
                        <!--                        </td>-->
                        <td>
                            <span t-field="o.partner_id.name"/>
                        </td>
                        <td>
                            <span t-field="o.street"/>
                        </td>
                        <td>
                            <span t-field="o.zone"/>
                        </td>
                        <td>
                            <span t-field="o.mobile"/>
                        </td>
                        <td>
                            <span t-field="o.amount"/>
                        </td>

                        <td>

                            <span t-field="o.state" class=" badge badge-pill badge-info"
                                  title="Current stage of this task"/>
                        </td>
                        <td>
                            <a t-attf-href="/manage/delivery/#{o.id}" class="btn btn-primary btn-sm"
                               t-if="o.state == '1'">
                                <i class="fa fa-book"/>
                                Arrived
                            </a>
                        </td>


                    </tr>
                </t>
            </t>
        </t>
    </template>


    <!--    <template id="detail_delivery_orders" name="Detail Delivery Orders">-->
    <!--        <t>-->
    <!--            <div class="container">-->
    <!--                <div class="row mt16">-->
    <!--                    <div class="offset-1 col-6">-->
    <!--                        <h1 t-field="o.sudo().account_move_id.name"/>-->
    <!--                        <t>-->
    <!--                            <div t-field="o.sudo().partner_id.name" class="text-muted"/>-->
    <!--                        </t>-->
    <!--&lt;!&ndash;                        <b class="mt8"> Authors </b>&ndash;&gt;-->
    <!--                        <ul>-->
    <!--                            <li t-foreach="o.account_move_id.invoice_line_ids" t-as="author">-->
    <!--                                <span t-esc="author.product_id.name"/>-->
    <!--                            </li>-->
    <!--                        </ul>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </t>-->
    <!--    </template>-->


    <template id="detail_delivery_orders" name="Detail Delivery Orders">
        <t t-call="portal.portal_layout">
            <div id="wrap">
                <div class="container">
                    <t t-call="portal.portal_record_layout">
                        <t t-set="card_header">
                            <div class="row no-gutters">
                                <div class="col-md">
                                    <h5 class="mb-1 mb-md-0">
                                        <span t-field="o.sudo().account_move_id.name"/>
                                        <small class="text-muted">(#<span t-field="o.sudo().account_move_id.id"/>)
                                        </small>
                                    </h5>
                                </div>
                                <div class="col-md text-md-right">
                                    <small class="text-right">Status:</small>
                                    <span t-field="o.sudo().state" class=" badge badge-pill badge-info"
                                          title="Current stage of this order"/>
                                </div>
                            </div>
                        </t>
                        <t t-set="card_body">
                            <div class="row mb-4">
                                <h3></h3>
                                <div class="col-12">
                                    <strong>
                                        <h5 style="color:#267372;">Customer Details :</h5>
                                    </strong>
                                </div>
                                <div class="col-md-6">
                                    <strong>Customer:</strong>
                                    <span t-field="o.sudo().partner_id.name" style="white-space: nowrap;"/>
                                </div>
                                <div class="col-md-6">
                                    <strong>Mobile:</strong>
                                    <span t-field="o.sudo().mobile"/>
                                </div>
                                <div class="col-md-6">
                                </div>
                                <br></br>
                                <br></br>
                                <div class="col-12">
                                    <strong>
                                        <h5 style="color:#267372;">Address Details :</h5>
                                    </strong>
                                </div>
                                <div class="col-md-6">
                                    <strong>Street :</strong>
                                    <span t-field="o.sudo().street"/>
                                </div>
                                <div class="col-md-6">
                                    <strong>Zone :</strong>
                                    <span t-field="o.sudo().zone"/>
                                </div>
                                <br></br>
                                <br></br>
                                <div class="col-12">
                                    <strong>
                                        <h3 style="color:#267372;type:right"></h3>
                                    </strong>
                                </div>
                                <div class="col-md-6">
                                </div>
                            </div>
                            <div>
                                <t t-call="portal.portal_table">
                                    <thead>
                                        <tr class="active">
                                            <th>product</th>
                                            <th>quantity</th>
                                            <th>Price Unit</th>
                                            <th>Price Subtotal</th>
                                        </tr>
                                    </thead>
                                    <t t-foreach="o.sudo().account_move_id.invoice_line_ids" t-as="author">
                                        <tr>
                                            <td>
                                                <span t-field="author.sudo().product_id.name"/>
                                            </td>
                                            <td>
                                                <span t-field="author.sudo().quantity"/>
                                            </td>
                                            <td>
                                                <span t-field="author.sudo().price_unit"/>
                                            </td>
                                            <td>
                                                <span t-field="author.sudo().price_subtotal"/>
                                            </td>

                                        </tr>
                                    </t>
                                </t>
                            </div>
                            <div class="text-right" align="right">
                                <h5 style="color:#267372;type:center">Salary Details :</h5>
                                <strong>Amount :</strong>
                                <span t-field="o.sudo().amount"/>
                            </div>
                        </t>
                    </t>
                </div>
            </div>
        </t>
    </template>

    <record id="sale.portal_my_home_sale" model="ir.ui.view">
        <field name="customize_show" eval="True"/>
        <field name="active" eval="False"/>
    </record>

    <record id="account.portal_my_home_invoice" model="ir.ui.view">
        <field name="customize_show" eval="True"/>
        <field name="active" eval="False"/>
    </record>


    <!--    <record id="hr_timesheet.portal_my_home_timesheet" model="ir.ui.view">-->
    <!--        <field name="customize_show" eval="True" />-->
    <!--        <field name="active" eval="False" />-->
    <!--    </record>-->

    <record id="purchase.portal_my_home_purchase" model="ir.ui.view">
        <field name="customize_show" eval="True"/>
        <field name="active" eval="False"/>
    </record>
    <!--    <record id="project.portal_my_home" model="ir.ui.view">-->
    <!--        <field name="customize_show" eval="True" />-->
    <!--        <field name="active" eval="False" />-->
    <!--    </record>-->
</odoo>
